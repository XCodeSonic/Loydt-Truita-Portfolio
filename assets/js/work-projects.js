const projects = [
  {
    client: "Opol Community College",
    location: "Opol Misamis Oriental, Philippines",
    service: "Full Package",
    year: "2024",
    income: "N/A",
    image: '/assets/projects/images/1p7.png'
  },
  {
    client: "Programming 2",
    location: "Opol Misamis Oriental, Philippines",
    service: "Full Package",
    year: "2024",
    income: "N/A",
    image: '/assets/projects/images/2p8.png'
  },
  {
    client: "Opol Community College",
    location: "Opol Misamis Oriental, Philippines",
    service: "Photography",
    year: "2024",
    income: "N/A",
    image: '/assets/projects/images/3p5.jpg'
  },
  {
    client: "明學 林",
    location: "Taiwan",
    service: "Tutor",
    year: "2025",
    income: "+₱5,259.80 PHP",
    image: '/assets/images/day-and-night.gif'
  },
  {
    client: "Siou song",
    location: "Kampung Emrdeka, Cambodia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,822.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Siou song",
    location: "Kampung Emrdeka, Cambodia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱8,845.34 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱2,853 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Siou song",
    location: "Kampung Emrdeka, Cambodia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,136.48 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Siou song",
    location: "Kampung Emrdeka, Cambodia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱15,280.57 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,617.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "明學 林",
    location: "Taiwan",
    service: "Tutor",
    year: "2024",
    income: "+₱3,809 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱4,765 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Winglma lau",
    location: "N/A, N/A",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,586.29 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,897 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,436.60 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,436.60 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,338.60 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,436.60 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,617.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,434.20 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,809 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,419 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱6,007.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱6,103.40 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,809 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱8,589 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Roong Tzuu Ong",
    location: "Perak, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,705 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,147.40 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,044.20 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,705.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,791.84 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,405.52 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱5,243 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,598.68 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Addy Ling",
    location: "Melbourne, Australia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,490.70 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,044.20 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "Development",
    year: "2024",
    income: "+₱11,457 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱4,765 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Vogel sim",
    location: "Johor, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱1,227.80 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱3,809 PHP",
    image: '/assets/images/profile/profile.png'
  },
  {
    client: "Muhamad Mohd Ishah",
    location: "Melaka, Malaysia",
    service: "3d Modelling",
    year: "2024",
    income: "+₱2,853 PHP",
    image: '/assets/images/profile/profile.png'
  }
];

const projectContainer = document.getElementById('projects-container');

// Create hover container
function createHoverContainer() {
  const hoverContainer = document.createElement('div');
  hoverContainer.className = 'project-hover-container';

  const hoverImage = document.createElement('img');
  hoverImage.className = 'project-hover-image';
  hoverImage.onerror = function() {
    this.src = 'https://via.placeholder.com/200x150?text=Project+Image';
  };

  const viewBtn = document.createElement('div');
  viewBtn.className = 'project-hover-view-btn';
  viewBtn.textContent = 'View';

  hoverContainer.appendChild(hoverImage);
  hoverContainer.appendChild(viewBtn);
  document.body.appendChild(hoverContainer);

  return hoverContainer;
}

// Initialize hover effects with smooth trailing
function initHoverEffects() {
  const hoverContainer = document.querySelector('.project-hover-container') || createHoverContainer();
  const hoverImage = hoverContainer.querySelector('.project-hover-image');
  const viewBtn = hoverContainer.querySelector('.project-hover-view-btn');

  let hoverTimeout;
  let currentProject = null;
  let mouseX = 0;
  let mouseY = 0;
  let containerX = 0;
  let containerY = 0;
  let isHovering = false;

  // Smooth follow animation
  function animate() {
    // Calculate distance between cursor and container
    const dx = mouseX - containerX;
    const dy = mouseY - containerY;
    
    // Apply easing (the divisor controls the "lag" amount)
    containerX += dx / 10;
    containerY += dy / 10;
    
    // Update container position
    hoverContainer.style.left = `${containerX}px`;
    hoverContainer.style.top = `${containerY}px`;
    
    // Continue animation if hovering
    if (isHovering) {
      requestAnimationFrame(animate);
    }
  }

  function handleMouseEnter(e) {
    clearTimeout(hoverTimeout);
    currentProject = e.currentTarget;
    const imagePath = currentProject.getAttribute('data-image') || 'https://via.placeholder.com/200x150?text=Project+Image';

    // Initialize positions
    mouseX = e.clientX;
    mouseY = e.clientY;
    containerX = mouseX;
    containerY = mouseY;
    
    hoverContainer.style.display = 'block';
    hoverContainer.style.left = `${containerX}px`;
    hoverContainer.style.top = `${containerY}px`;

    hoverImage.src = imagePath;
    hoverImage.style.transform = 'translateY(-20px)';
    hoverImage.style.opacity = '0';
    viewBtn.style.opacity = '0';

    setTimeout(() => {
      hoverImage.style.transform = 'translateY(0)';
      hoverImage.style.opacity = '1';
      viewBtn.style.opacity = '1';
    }, 50);

    isHovering = true;
    animate();
  }

  function handleMouseMove(e) {
    if (currentProject === e.currentTarget) {
      // Update mouse position
      mouseX = e.clientX;
      mouseY = e.clientY;
    }
  }

  function handleMouseLeave() {
    if (currentProject === this) {
      hoverImage.style.opacity = '0';
      hoverImage.style.transform = 'translateY(20px)';
      viewBtn.style.opacity = '0';

      hoverTimeout = setTimeout(() => {
        hoverContainer.style.display = 'none';
        currentProject = null;
        isHovering = false;
      }, 300);
    }
  }

  // Remove existing listeners and add new ones
  document.querySelectorAll('.project').forEach(project => {
    project.removeEventListener('mouseenter', handleMouseEnter);
    project.removeEventListener('mousemove', handleMouseMove);
    project.removeEventListener('mouseleave', handleMouseLeave);
    
    project.addEventListener('mouseenter', handleMouseEnter);
    project.addEventListener('mousemove', handleMouseMove);
    project.addEventListener('mouseleave', handleMouseLeave);
  });
}

// Render projects based on filter
function renderProjects(filter) {
  projectContainer.innerHTML = '';

  const filtered = filter === 'All'
    ? projects
    : projects.filter(p => {
        if (filter === 'Design') return p.service === '3d Modelling';
        if (filter === 'Development') return p.service === 'Development';
        if (filter === 'Full Package') return p.service === 'Full Package';
        if (filter === 'Photo & Videography') return p.service === 'Photography' || p.service === 'Videography';
        if (filter === 'Tutor') return p.service === 'Tutor';
        return false;
      });

  // const projectImages = [
  //   '/assets/images/profile/profile.png',
  //   '/assets/images/day-and-night.gif',
  //   '/assets/images/earth.gif',
  //   // Add more as needed
  // ];

  filtered.forEach((p, index) => {
    const div = document.createElement('div');
    div.classList.add('project');
    // Use the project's image property or fallback to placeholder
    div.setAttribute('data-image', p.image || 'https://via.placeholder.com/200x150?text=Project+Image');
    div.innerHTML = `
      <p><strong>${p.client}</strong></p>
      <p>${p.location}</p>
      <p>${p.service}</p>
      <p>${p.year}</p>
      <p>${p.income}</p>
    `;
    projectContainer.appendChild(div);
  });

  initHoverEffects();
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
  // Create hover container first
  createHoverContainer();

  // Initial render
  renderProjects('All');

  // Filter event listeners
  document.getElementById('filter-all')?.addEventListener('click', () => renderProjects('All'));
  document.getElementById('filter-design')?.addEventListener('click', () => renderProjects('Design'));
  document.getElementById('filter-development')?.addEventListener('click', () => renderProjects('Development'));
  document.getElementById('filter-fullpackage')?.addEventListener('click', () => renderProjects('Full Package'));
  document.getElementById('filter-photovideography')?.addEventListener('click', () => renderProjects('Photo & Videography'));
  document.getElementById('filter-tutor')?.addEventListener('click', () => renderProjects('Tutor'));
});